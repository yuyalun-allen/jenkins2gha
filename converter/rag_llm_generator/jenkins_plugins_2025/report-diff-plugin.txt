# jenkins-report-diff
Jenkins plugin to monittor comaprable content on system

* [Job run details](#job)
* [Project state graph](#project)
    * [tooltip](#tooltip)
* [Settings](#settings)
    * [customizations](#customizations)
* [Multiple diffs](#multiple-diffs)
* [Changing build status](#changing-build-status)
* [Dynamic patch-like view](#dynamic-patch-like-view)
* [Dependences](#dependences)
    
This plugin allows you to monitor any difference in output of file or of rnu of any command, where unit is an line.
Exemplar usage is `rpm -qa` - then during every run, all packages on system are stored, and during next run they are compared.
Or `env` to monitor all variables in job `find` above specific path and so on. 
Of course if yours monitoring is supposed to be multios, the content must be generated by 3rd party logic or use [Multiple diffs](#multiple-diffs) - one diff per command. On incompatible os, it willbe simply skipp (just do not fail run on failure via [Changing build status](#changing-build-status))

## Job
Most detaield view cnabe shown from build screen
![koji-jtreg-rpms](https://user-images.githubusercontent.com/2904395/43510354-a8f3e86c-9575-11e8-9318-c3516d65a876.png)

In job build screen, simple, but a lot of saying  ```RPM Changes: X RPMs installed, Y RPMs removed``` is provided, where **RPM Changes** is link to following screen.
Note, that Rpm Changes, Rpms installed and RPMs removed are **custom** strings which describe the changes you are monitoring.  See *advanced* section in job config of plugin. 
 
![run](https://user-images.githubusercontent.com/2904395/43015810-eb0c74fe-8c50-11e8-8420-ec3fb8df6037.png)

You can nicely see what lines (packages in our case)  had changed.

## Project
For quick overview, you have in-project graph:
![project](https://user-images.githubusercontent.com/2904395/43015811-eb2dc942-8c50-11e8-9bd7-56e71254c7f0.png)

this graph shows  how many lines was in stream, how many lines were removed compared to previous,  how many lines were added.

### Tooltip
The tooltip says it in manner of original purpose - difference in lines (installed packages in our example:
![tooltip](https://user-images.githubusercontent.com/2904395/43015812-eb4dbe50-8c50-11e8-81fa-b22cc9d0458c.png)

Unluckily the total - blackline, added - green line and removed as red line in one graph was not happy choice. Usually minor adds/removes are not visible. Wehn we do an system update, graph loks like:
![update](https://user-images.githubusercontent.com/2904395/43122742-61016178-8f22-11e8-8817-28d6da1dc57e.png)

So although you see major changes, the red and green lines get mixed.

## Settings
When you look to the sedttings:
![settings](https://user-images.githubusercontent.com/2904395/43122741-60e40448-8f22-11e8-84c2-de47d9c8e4be.png)

You can see it is comand or file what you put here. It operates on workspace, so the file do not need to be archived (as is celar from nature of command xor file)

###  customizations
You can set up all the labels acording your taste, and thus give meaning to the diff you are presenting

## Multiple diffs
You can havew sevral diffs, each comparing different command/file. According to this, several charts is show and several reports is navigable and collapsable in main report. Eah comaprsion have **ID** wich is mandatory to set, and is apointing the base line. Chnage of id == lost/change of baseline. 
Each of your charts can have separate title, and names of statuses (aka added lines x installed apps x new variables ).

## Changing build status
You can set up plugin to change build status to unstable if there is change detected by diff.

You can set up plugin to change build status to failed if there command/readign fails and/or nothing is read.


## Dynamic patch-like view
The plugin can dynamicaly calcualte difference in monitored files/commands between any two jobs in patch-like view. From main screen:

![patch1](https://github.com/jenkinsci/report-diff-plugin/assets/2904395/102acd87-1e67-44d7-b992-f9f1fcc4cf49)

You can click **/patch:** whch will bring you directly to diff, eg *.../45/patch/dynamic-diff?from=45&to=44&ids=.\*&context=-1*:

![patch2](https://github.com/jenkinsci/report-diff-plugin/assets/2904395/a28412d6-4437-419f-a458-324d1f5ea1d4)

where you can modify the GET parameters as needed. Or you can clicl the **Patch like report** whcih will bring you to form:

![patch3](https://github.com/jenkinsci/report-diff-plugin/assets/2904395/ac8b7707-3314-4601-9924-8486ecfc0ab2)

Which allows you to set the GET parameter via gui.

Note, that individual *ids* are in reality regexes. 
Plain diff and visualised diff is based on https://github.com/java-diff-utils/java-diff-utils 

## Dependences
This plugin depends on [chartjs-api](https://github.com/jenkinsci/chartjs-api-plugin) library plugin
